---
Keywords: ctf,cpawctf
Copyright: (C) 2020 しろくまの雑記帳
---

# CpawCTFにチャレンジしてみた(Level.1編)

---

### 一問目 Test Probrem ジャンル・Misc

---

問題の指示に従って答えを入力すればOK。

  

### 二問目 Classical Cipher ジャンル・Crypto

---

#### 問題

暗号には大きく分けて、古典暗号と現代暗号の2種類があります。特に古典暗号では、古代ローマの軍事的指導者ガイウス・ユリウス・カエサル（英語読みでシーザー）が初めて使ったことから、名称がついたシーザー暗号が有名です。これは3文字分アルファベットをずらすという単一換字式暗号の一つです。次の暗号文は、このシーザー暗号を用いて暗号化しました。暗号文を解読してフラグを手にいれましょう。

暗号文: fsdz{Fdhvdu_flskhu_lv_fodvvlfdo_flskhu}

#### 解法

問題文より暗号文を三文字シフトすれば平文が得られる。

  
### 三問目 Can you execute? ジャンル・Reversing

---

#### 問題

拡張子がないファイルを貰ってこのファイルを実行しろと言われたが、どうしたら実行出来るのだろうか。
この場合、UnixやLinuxのとあるコマンドを使ってファイルの種類を調べて、適切なOSで実行するのが一般的らしいが…

#### 解法

まずは、ファイルをダウンロード。
パーミッションを編集して実行する。
MacOSでは動かなかった。
(こういうファイルは実機上ではなく、仮想マシン上で動かしたほうが良い。今回はちょっと横着した。)

fileコマンドで調べると

        exec_me: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, 
        for GNU/Linux 2.6.24, BuildID[sha1]=663a3e0e5a079fddd0de92474688cd6812d3b550, not stripped

と出た。
というわけで、ParrotOSがインストールされた別のマシンで実行してフラグゲット。

  
### 四問目 Can you open this file? ジャンル・Misc

---

#### 問題

このファイルを開きたいが拡張子がないので、どのような種類のファイルで、どのアプリケーションで開けば良いかわからない。
どうにかして、この拡張子がないこのファイルの種類を特定し、どのアプリケーションで開くか調べてくれ。

#### 解法

とりあえず、ダウンロードしたファイルをfileコマンドで調べる。
出力された情報を読むと、`Microsoft Office Word` と書かれている。
Wordで開けばおｋ。
(LibreOffice,OpenOfficeでも可)

  
###  五問目 HTML Page ジャンル・Web

---

#### 問題

HTML(Hyper Text Markup Language)は、Webサイトを記述するための言語です。
ページに表示されている部分以外にも、ページをより良くみせるためのデータが含まれています。
次のWebサイトからフラグを探して下さい。
(念の為リンクは未掲載としています。)

※この問題のサーバへの攻撃はお止めください。

#### 解法

サイトにアクセスして、ブラウザのデベロッパーツールを開く。
ヘッダータグ内を確認するとフラグが見つかる。
  

### 六問目 River ジャンル・Forensics

---

#### 問題

JPEGという画像ファイルのフォーマットでは、撮影時の日時、使われたカメラ、位置情報など様々な情報(Exif情報)が付加されることがあるらしい。
この情報から、写真に写っている川の名前を特定して欲しい。
問題ファイル： river.jpg

FLAGの形式は、"cpaw{river_name}"
例：隅田川 → cpaw{sumidagawa}

#### 解法

Exif情報から緯度と経度を確認してこの川を探す。
ツールはなんかしらのWebサービスなり地図アプリなど何でも良い。

  
### 七問目 pcap ジャンル・Network

---

#### 問題

ネットワークを流れているデータはパケットというデータの塊です。
それを保存したのがpcapファイルです。
pcapファイルを開いて、ネットワークにふれてみましょう！

#### 解法

ダウンロードしたpcapファイルをWiresharkで開くだけ。

  
### 八問目 HashHashHash! ジャンル・Crypto

---

#### 問題

ハッシュ関数とは、値を入れたら絶対にもとに戻せないハッシュ値と呼ばれる値が返ってくる関数です。
ですが、レインボーテーブルなどでいくつかのハッシュ関数は元に戻せてしまう時代になってしまいました。
以下のSHA1というハッシュ関数で作られたハッシュ値を元に戻してみてください！（ヒント：googleで検索）

e4c6bced9edff99746401bd077afa92860f83de3

#### 解法

手っ取り早くWebサービスでデコードしよう。
[Hash Toolkit](https://hashtoolkit.com)や[CrackStation](https://crackstation.net)おすすめ。

##### 別解 hashcatを使って解析してみた

1. crackstation.netからワードリストをダウンロード(crackstation.txt.gz)
2. hash.lstというファイルを作ってそこに問題のハッシュを書き込む。
3. 以下のコマンドを打つ

        hashcat -m 100 -a 0 -o crack.txt --remove hash.lst /path/to/crackstation.txt
        (--removeいらないかも)

4. hashcatの処理が完了したら、`crack.txt`を確認する

i7-3632QMで7分かかった。

### 九問目 並べ替えろ！ ジャンル・PPC

---

#### 問題

下にある配列の中身を大きい順に並べ替えて、くっつけてcpaw{並べ替えた後の値}をフラグとして提出してください。
例：もし配列｛1,5,3,2｝っていう配列があったら、大きい順に並べ替えると｛5,3,2,1}となります。
そして、フラグはcpaw{5321}となります。
同じようにやってみましょう（ただし量が多いので、ソートするプログラムを書いたほうがいいですよ！）


[15,1,93,52,66,31,87,0,42,77,46,24,99,10,19,36,27,4,58,76,2,81,50,102,33,94,20,14,80,82,49,41,12,143,121,
7,111,100,60,55,108,34,150,103,109,130,25,54,57,159,136,110,3,167,119,72,18,151,105,171,160,144,85,201,
193,188,190,146,210,211,63,207]

#### 解法

pythonと対話した。

        1. >>> a = [15,1,93,52,66,31,87,0,42,77,46,24,99,10,19,36,27,4,58,76,2,81,50,102,33,94,20,14,80,82,49,41,12,143,121,7,111,100,60,55,108,34,150,103,109,130,25,54,57,159,136,110,3,167,119,72,18,151,105,171,160,144,85,201,193,188,190,146,210,211,63,207]
        2. >>> b = sorted(a, reverse=True)
        3. >>> c = map(str, b)
        4. >>> d = ''.join(c)
        5. >>> print(d)

リストを作って降順でソート。(1,2)
カンマを除去するために`join`メソッドを使って、区切りなしで連結したいが、文字列型でないと
要素の連結ができないので、`map`関数を使って変換。(3 -> 4)
そして表示。(5)
 

